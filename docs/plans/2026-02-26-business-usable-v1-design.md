# 业务可用版（A档）前端与流程优化设计（2026-02-26）

## 1. 目标与边界

- 目标：将当前“演示骨架”提升为“业务可用”版本，可支撑日常协作。
- 范围：`登录 + 项目管理 + 需求管理 + 任务管理 + Bug 管理`。
- 本轮不做：复杂权限、多角色数据隔离、领导看板深度分析、外部系统深度对接。
- 可用标准：
  - 四模块具备“列表可查、记录可建、状态可流转、关键字段可编辑”。
  - 每条主流程可重复操作，不依赖人工改库。
  - 常见异常（校验失败、非法流转、网络失败）有明确提示和可恢复操作。

## 2. 方案对比与选择

### 方案 1：补丁式增强（最快）

- 方式：在现有代码上逐项补功能。
- 优点：见效快。
- 风险：长期维护成本高，容易形成交互与代码碎片。

### 方案 2：保留架构的模块级重构（最终选择）

- 方式：保留技术栈与路由结构，统一四模块页面形态与流程动作。
- 优点：在可控周期内达到可用，且后续可扩展权限/看板。
- 风险：比补丁式慢，但质量与可维护性更高。

### 方案 3：前后端大幅重做（最彻底）

- 方式：全面重建交互模型与接口规范。
- 优点：长期最优。
- 风险：周期与风险超出当前目标。

**结论：采用方案 2。**

## 3. 核心业务边界（需求 vs 任务）

- 需求（Requirement）：表达“要做什么/为什么做/业务价值”。
- 任务（Task）：表达“谁来做/怎么做/何时完成/工时投入”。

系统规则：

- 一个需求可拆分多个任务（`1 -> N`）。
- 任务必须归属项目；任务可选关联需求。
- 任务完成不等于需求关闭；需求关闭需满足业务验收。
- Bug 优先关联任务；无明确任务时可关联需求。

## 4. 四模块流程设计（A档可用）

### 4.1 项目管理

- 流程：创建项目 → 编辑信息 → 归档/恢复。
- 字段：项目名、负责人、开始日期、结束日期、状态（进行中/已归档）。
- 列表能力：状态筛选、关键字搜索、更新时间排序。

### 4.2 需求管理

- 流程：新建需求 → 评审 → 关闭（支持驳回）。
- 状态：`NEW -> REVIEWED -> CLOSED`，支持 `REVIEWED -> NEW`（驳回）。
- 字段：标题、所属项目、优先级、负责人、描述、验收标准、状态。
- 动作：评审、驳回、关闭、编辑、拆分任务。

### 4.3 任务管理

- 流程：新建任务 → 开始执行 → 记录工时 → 完成。
- 状态：`TODO -> DOING -> DONE`。
- 字段：标题、所属项目、来源需求（可空）、负责人、预计工时、已用工时、状态。
- 动作：开始、登记工时、完成、编辑。

### 4.4 Bug 管理

- 流程：提交 → 指派 → 解决 → 验证 → 关闭。
- 状态：`OPEN -> ASSIGNED -> RESOLVED -> VERIFIED -> CLOSED`。
- 字段：标题、严重级别、项目、任务（可空）、指派人、复现步骤、状态。
- 动作：指派、解决、验证、关闭、编辑。

## 5. 前端页面与交互重构

统一形态：

- 顶部筛选区（状态/关键字/负责人/项目）。
- 中部表格区（核心字段 + 状态 + 更新时间）。
- 详情/编辑采用抽屉或弹窗（减少跳页成本）。
- 行内动作按当前状态动态显示合法操作。

统一交互规则：

- 新建与编辑复用同一表单组件。
- 提交动作统一 loading、成功提示、失败提示。
- 成功后局部刷新列表，不整页重载。
- 空状态、异常状态、网络失败提供明确引导与重试。

## 6. 接口与数据最小改造清单

### 6.1 项目

- 新增/补齐字段：`owner`、`startDate`、`endDate`、`status`。
- 接口：
  - `GET /api/pm/projects`
  - `PUT /api/pm/projects/{id}`
  - `PUT /api/pm/projects/{id}/archive`
  - `PUT /api/pm/projects/{id}/restore`

### 6.2 需求

- 新增/补齐字段：`priority`、`owner`、`description`、`acceptanceCriteria`。
- 接口：
  - `GET /api/pm/requirements`
  - `PUT /api/pm/requirements/{id}`
  - `PUT /api/pm/requirements/{id}/review`
  - `PUT /api/pm/requirements/{id}/reject`
  - `PUT /api/pm/requirements/{id}/close`

### 6.3 任务

- 新增/补齐字段：`requirementId`（可空）、`assignee`、`estimatedHours`、`spentHours`。
- 接口：
  - `GET /api/pm/tasks`
  - `PUT /api/pm/tasks/{id}`
  - `PUT /api/pm/tasks/{id}/start`
  - `POST /api/pm/tasks/{id}/worklogs`
  - `PUT /api/pm/tasks/{id}/done`

### 6.4 Bug

- 新增/补齐字段：`projectId`、`taskId`（可空）、`stepsToReproduce`。
- 接口：
  - `GET /api/pm/bugs`
  - `PUT /api/pm/bugs/{id}`
  - `PUT /api/pm/bugs/{id}/assign`
  - `PUT /api/pm/bugs/{id}/resolve`
  - `PUT /api/pm/bugs/{id}/verify`
  - `PUT /api/pm/bugs/{id}/close`

### 6.5 通用约定

- 列表统一支持：`page`、`size`、`keyword`、`status`、`projectId`。
- 错误统一：`code + message`。
- 保持前端对旧接口兼容，按增量方式切换到新接口。

## 7. 两周落地节奏

### 第 1 周（后端主流程可用）

- 完成四模块列表/编辑/流转接口补齐。
- 固化需求与任务边界校验。
- 补充接口文档供联调。

### 第 2 周（前端可用体验收口）

- 完成四模块页面统一重构。
- 打通主流程交互与反馈。
- 增加关键回归测试并完成联调演示。

## 8. 验收清单

- 项目：创建/编辑/归档/恢复可用。
- 需求：新建/评审/驳回/关闭可用，且可关联任务。
- 任务：新建/开始/登记工时/完成可用，支持来源需求。
- Bug：提交/指派/解决/验证/关闭可用，支持关联项目/任务。
- 异常场景可恢复，页面不崩溃。
- 需求 → 任务 → Bug 至少具备单向追踪链路。
